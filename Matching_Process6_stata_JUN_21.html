<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<h1><a href="#database-step-6" id="database-step-6">Database (step 6)</a></h1>
<p>Date created: 22 Sep 2021.</p>
<p>Install commands that are unavailable or out of date.</p>
<pre><code>. clear all

. *rnethelp &quot;http://www.stata-journal.com/software/sj13-1/st0289/stjm.sthlp&quot;
. 
. cap noi which predictms
C:\Users\CISS Fondecyt\ado\plus\p\predictms.ado
*! version 4.3.0 14mar2021 MJC

. if _rc==111 {
.         cap noi net install multistate, from(&quot;https://www.mjcrowther.co.uk/code/multistate&quot;) 
.         }

. cap noi which merlin
C:\Users\CISS Fondecyt\ado\plus\m\merlin.ado
*! version 2.0.2 19mar2021 MJC

. if _rc==111 {
.         cap noi net install merlin, from(&quot;https://www.mjcrowther.co.uk/code/merlin/&quot;) 
.         }

. cap noi which sumat
C:\Users\CISS Fondecyt\ado\plus\s\sumat.ado
*! Part of package matrixtools v. 0.25
*! Support: Niels Henrik Bruun, niels.henrik.bruun@gmail.com
*! 2021-01-03 toxl added

. if _rc==111 {
.         cap noi scc install matrixtools
.         }

. cap noi which estwrite
C:\Users\CISS Fondecyt\ado\plus\e\estwrite.ado
*! version 1.2.4 04sep2009
*! version 1.0.1 15may2007 (renamed from -eststo- to -estwrite-; -append- added)
*! version 1.0.0 29apr2005 Ben Jann (ETH Zurich)

. if _rc==111 {
.         cap noi ssc install estwrite
.         }       

.         
. cap noi which scurve_tvc
C:\Users\CISS Fondecyt\ado\plus\s\scurve_tvc.ado

. if _rc==111 {
.         cap noi net install st0458, from(&quot;http://www.stata-journal.com/software/sj16-4&quot;)
.         }

. cap noi which strmcure  
C:\Users\CISS Fondecyt\ado\plus\s\strmcure.ado
*! Version 4.0 31-Aug-2015

. if _rc==111 {
.         cap noi net install st0374_1, from (&quot;http://www.stata-journal.com/software/sj18-2&quot;)
.         }

. cap noi which stjmgraph 
C:\Users\CISS Fondecyt\ado\plus\s\stjmgraph.ado
*! version 1.0.2 01Jun2011 MJC

. if _rc==111 {
.         cap noi net install st0289, from (&quot;http://www.stata-journal.com/software/sj13-1&quot;)
.         }       

</code></pre>
<p>We need to obtain the file and the work folder.</p>
<pre><code>. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;/volumes/sdrive/data//&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;/volumes/sdrive/data//&quot;
.         global pathdata &quot;/volumes/sdrive/data//&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata &quot;E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;E:/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;G:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;G:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata &quot;G:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;G:/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

.                 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)&quot;
C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)
.         global pathdata &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
Location= C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags; Date: 22 Sep 2021, considering an OS Windows for the user: CISS Fondecyt
. }

. else display &quot;This file does not exist&quot;

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;C:\Users\andre\Desktop\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;C:\Users\andre\Desktop\_mult_state_ags&quot;
.         global pathdata &quot;C:\Users\andre\Desktop\_mult_state_ags&quot;
.         global pathdata2 &quot;C:/Users/andre/Desktop/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;C:\Users\CISS Fondecyt\OneDrive\Documentos\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags
.         global pathdata &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
Location= C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags; Date: 22 Sep 2021, considering an OS Windows for the user: CISS Fondecyt
. }

. else display &quot;This file does not exist&quot;

. 
</code></pre>
<p>Path data= C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)_mult_state_ags;</p>
<p>Timestamp: 22 Sep 2021, considering that is a Windows OS for the username: CISS Fondecyt</p>
<p>The file is located and named as: C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/archivo_multiestado5_jun.dta</p>
<p>=============================================================================</p>
<h2><a href="#pwp-tt" id="pwp-tt">PWP-TT</a></h2>
<p>=============================================================================</p>
<pre><code>. **https://europepmc.org/articles/PMC5805119/bin/qcx015_supp.pdf
. cap qui use &quot;${pathdata2}five_st_msprep_jun.dta&quot;, clear 

. matrix mat_five_states = (.,1,.,.,. \ .,.,2,.,. \.,.,.,3,. \.,.,.,.,4 \.,.,.,.,.)

. msset, id(id) states(Readmission_status Readmission2_status Readmission3_status Readmission4_status) ///
&gt;                 times(Readmission_time Readmission2_time Readmission3_time Readmission4_time) transmatrix(mat_five_states)  //* saqué tipo_de_plan_res_1 para que no se empiece a subdividir

. gen time = _stop - _start

. *originally i set this:
. stset _stop, fail(_status) exit(time .) id(id) enter(_start)

                id:  id
     failure event:  _status != 0 &amp; _status &lt; .
obs. time interval:  (_stop[_n-1], _stop]
 enter on or after:  time _start
 exit on or before:  time .

------------------------------------------------------------------------------
     31,968  total observations
          0  exclusions
------------------------------------------------------------------------------
     31,968  observations remaining, representing
     22,912  subjects
      9,261  failures in multiple-failure-per-subject data
   44771646  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     4,431

. 
. *This is the correct stset for discontinuous risk intervals
. *b)* Prentice, Williams and Peterson Total Time (PWP-TT)
. *****Events are ordered and handled by stratification
. *****The PWP models are conditional models
. *****Everyone is at risk for the first stratum, but only who had
. ********an event in the previous stratum are at risk for the
. ********successive one
. *****It can estimate both overall and event-specific effects
. *****It uses robust standard errors to account for correlation
. ********(variance-corrected method)
. 
. *#Using counting process data structure the PWP-TT model may be fit using:
. *The nohr option can be used with stcox command to request estimated coefficients, instead of hazard ratios. The robust option produces a robust sandwich estimate for covariance matrix. The exit time option defines the time wh
&gt; en a subject stops being at risk. For multivariate survival data, in particular, it needs to be specified as exit(time .) because the default procedure is to remove the subject from the risk set after the first failure.
. *In our case, it is no necessit to specify exit(time .)
. 
. stcox  tipo_de_plan_res_1 TD_1 TD_2 TD_3 TD_4, efron robust nolog strata(_trans) schoenfeld(sch*) scaledsch(sca*)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Stratified Cox regr. -- Efron method for ties

No. of subjects      =          646             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(5)     =       40.40
Log pseudolikelihood =   -10918.064             Prob &gt; chi2      =      0.0000

                                         (Std. Err. adjusted for 646 clusters in id)
------------------------------------------------------------------------------------
                   |               Robust
                _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
tipo_de_plan_res_1 |   1.137168   .0527636     2.77   0.006     1.038316    1.245431
              TD_1 |    .783867   .0424746    -4.49   0.000     .7048865    .8716971
              TD_2 |   .8914284   .0515732    -1.99   0.047      .795867     .998464
              TD_3 |   .8410295   .0450834    -3.23   0.001      .757151    .9342001
              TD_4 |    1.06361   .0574035     1.14   0.253     .9568475    1.182285
------------------------------------------------------------------------------------
                                                          Stratified by _trans

. estat phtest, log detail

      Test of proportional-hazards assumption

      Time:  Log(t)
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob&gt;chi2
      ------------+---------------------------------------------------
      tipo_de_pl~1|     -0.04930         5.48        1         0.0192
      TD_1        |      0.13758        35.94        1         0.0000
      TD_2        |      0.01568         0.52        1         0.4699
      TD_3        |      0.01623         0.51        1         0.4737
      TD_4        |      0.00509         0.05        1         0.8227
      ------------+---------------------------------------------------
      global test |                     39.88        5         0.0000
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

. 
. *When to use it
. *****When the effects of covariates are different in subsequent events
. *****When the occurrence of the first event increases the likelihood of a recurrence
. *****When there are few recurrent events per subject
. 
. *****PWP-TT models could significantly underestimate the
. **********overall effect if there is no strong biological relationship
. **********between events
. 
. *****Thus, those methods could be proper for only handling a small number of
. **********recurrent events.
. 
. *c)* Prentice, Williams and Peterson Gap Time (PWP-GT)
. *In the PWP-TT model the time scale is time t, from beginning of study
. *In the PWP-GT model the time scale is time t, from the previous event
. 
. *Stratified Cox regr. -- Efron method for ties == efron
</code></pre>
<p>We checked the proportionality of hazards visually</p>
<pre><code>. stphplot if _trans==1, by(tipo_de_plan_res_1) adjust(TD_1 ) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: First transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_1, replace)  ///
&gt;         saving(stphplot_trans_1.gph, replace)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id
(file stphplot_trans_1.gph saved)

.         
. stphplot if _trans==2, by(tipo_de_plan_res_1) adjust(TD_1 TD_2 ) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: Second transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_2, replace)  ///
&gt;         saving(stphplot_trans_2.gph, replace)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id
(file stphplot_trans_2.gph saved)

.         
. stphplot if _trans==3, by(tipo_de_plan_res_1) adjust(TD_1 TD_2 TD_3 ) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: Third transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_3, replace)  ///
&gt;         saving(stphplot_trans_3.gph, replace)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id
(file stphplot_trans_3.gph saved)

.         
. stphplot if _trans==4, by(tipo_de_plan_res_1) adjust(TD_1 TD_2 TD_3 TD_4 ) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: Fourth transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_4, replace)  ///
&gt;         saving(stphplot_trans_4.gph, replace)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id
(file stphplot_trans_4.gph saved)

</code></pre>
<pre><code>. graph combine &quot;${pathdata}\stphplot_trans_1.gph&quot; &quot;${pathdata}\stphplot_trans_2.gph&quot; &quot;${pathdata}\stphplot_trans_3.gph&quot; &quot;${pathdata}\stphplot_trans_4.gph&quot;, ///
&gt; colfirst ycommon xcommon iscale(*.7) imargin(tiny) graphregion(color(gs16)) ///
&gt; title(&quot;Combination of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;PWP-TT&quot;, size(medium)) cols(2) ///
&gt; subtitle(&quot;{it: in each transition}&quot;, size(small)) ///
&gt; note(&quot;{it:              Note: Ordered by columns, from up to down, left to right}&quot;, size(tiny))

. graph export &quot;_trans_ph_ln_surv_time.png&quot;, as(png) replace width(2000) height(1000)
(file _trans_ph_ln_surv_time.png written in PNG format)

. graph export &quot;_trans_ph_ln_surv_time.pdf&quot;, as(pdf) replace //*width(2000) height(2000) orientation(landscape)
(file _trans_ph_ln_surv_time.pdf written in PDF format)

</code></pre>
<p><img src="_trans_ph_ln_surv_time.svg" width="800" ></p>
<p>Explored schoenfeld residuals:</p>
<pre><code>. drop sch* sca*

. stcox  i.tipo_de_plan_res_1 i.TD_1 i.TD_2 i.TD_3 i.TD_4, efron robust nolog strata(_trans) schoenfeld(sch*) scaledsch(sca*)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Stratified Cox regr. -- Efron method for ties

No. of subjects      =          646             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(5)     =       40.40
Log pseudolikelihood =   -10918.064             Prob &gt; chi2      =      0.0000

                                           (Std. Err. adjusted for 646 clusters in id)
--------------------------------------------------------------------------------------
                     |               Robust
                  _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
1.tipo_de_plan_res_1 |   1.137168   .0527636     2.77   0.006     1.038316    1.245431
              1.TD_1 |    .783867   .0424746    -4.49   0.000     .7048865    .8716971
              1.TD_2 |   .8914284   .0515732    -1.99   0.047      .795867     .998464
              1.TD_3 |   .8410295   .0450834    -3.23   0.001      .757151    .9342001
              1.TD_4 |    1.06361   .0574035     1.14   0.253     .9568475    1.182285
--------------------------------------------------------------------------------------
                                                          Stratified by _trans

. 
. estat phtest, log plot(1.tipo_de_plan_res_1) yline(0) msym(oh) ///
&gt;          xtitle(&quot;Time (days)&quot;, size(small)) ///
&gt;         xlabel(0(1460)5000, labsize(vsmall)) ///        
&gt;         ylabel(-4(1)4, labsize(vsmall)) ///     
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of scaled Schoenfeld residuals versus&quot; &quot;time produced for the covariate Treatment Modality&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: specified by Running mean smoother}&quot;,size(small)) ///
&gt;         name(phtest_log_plan_res, replace)  ///
&gt;         saving(phtest_log_plan_res.gph, replace)
(file phtest_log_plan_res.gph saved)

. ***The stphtest command with the plot option will provide the graphs with a lowess curve.  
. ***The usual graphing options can be used to include a horizontal reference line at y=0. 
</code></pre>
<p><img src="phtest_log_plan_res.svg" width="800" ></p>
<pre><code>. drop sch* sca*

. stcox  i.tipo_de_plan_res_1 i.TD_1 i.TD_2 i.TD_3 i.TD_4, efron robust nolog strata(_trans) schoenfeld(sch*) scaledsch(sca*)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Stratified Cox regr. -- Efron method for ties

No. of subjects      =          646             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(5)     =       40.40
Log pseudolikelihood =   -10918.064             Prob &gt; chi2      =      0.0000

                                           (Std. Err. adjusted for 646 clusters in id)
--------------------------------------------------------------------------------------
                     |               Robust
                  _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
1.tipo_de_plan_res_1 |   1.137168   .0527636     2.77   0.006     1.038316    1.245431
              1.TD_1 |    .783867   .0424746    -4.49   0.000     .7048865    .8716971
              1.TD_2 |   .8914284   .0515732    -1.99   0.047      .795867     .998464
              1.TD_3 |   .8410295   .0450834    -3.23   0.001      .757151    .9342001
              1.TD_4 |    1.06361   .0574035     1.14   0.253     .9568475    1.182285
--------------------------------------------------------------------------------------
                                                          Stratified by _trans

. 
. estat phtest, log plot(1.TD_1) yline(0) msym(oh) ///
&gt;          xtitle(&quot;Time (days)&quot;, size(small)) ///
&gt;         xlabel(0(1460)5000, labsize(vsmall)) ///        
&gt;         ylabel(-4(1)4, labsize(vsmall)) ///     
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of scaled Schoenfeld residuals versus&quot; &quot;time produced for the covariate Treatment Completion&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: specified by Running mean smoother}&quot;,size(small)) ///
&gt;         name(phtest_log_TD_1, replace)  ///
&gt;         saving(phtest_log_TD_1.gph, replace)
(file phtest_log_TD_1.gph saved)

. ***The stphtest command with the plot option will provide the graphs with a lowess curve.  
. ***The usual graphing options can be used to include a horizontal reference line at y=0. 
</code></pre>
<p><img src="phtest_log_TD_1.svg" width="800" ></p>
<p>We included an interaction with time in the type of plan at baseline and in treatment completion at baseline</p>
<pre><code>. *This interaction effect is best added using the tvc() and texp() options
. *https://static-content.springer.com/esm/art%3A10.1186%2F1475-2875-13-293/MediaObjects/12936_2014_3335_MOESM1_ESM.pdf
. stcox i.tipo_de_plan_res_1 i.TD_1 i.TD_2 i.TD_3 i.TD_4 _start , efron nolog robust strata(_trans) tvc(i.tipo_de_plan_res_1 i.TD_1)

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id


Stratified Cox regr. -- Efron method for ties

No. of subjects      =          646             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(8)     =       76.74
Log pseudolikelihood =   -10895.237             Prob &gt; chi2      =      0.0000

                                           (Std. Err. adjusted for 646 clusters in id)
--------------------------------------------------------------------------------------
                     |               Robust
                  _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
main                 |
1.tipo_de_plan_res_1 |   1.280613   .1123619     2.82   0.005     1.078283    1.520907
              1.TD_1 |   .4625426   .0554156    -6.44   0.000     .3657398    .5849668
              1.TD_2 |   .9001604   .0515394    -1.84   0.066     .8046068    1.007062
              1.TD_3 |   .8389973   .0442634    -3.33   0.001     .7565773     .930396
              1.TD_4 |   1.076205   .0568508     1.39   0.164     .9703538    1.193603
              _start |   .9997396   .0000675    -3.85   0.000     .9996073     .999872
---------------------+----------------------------------------------------------------
tvc                  |
1.tipo_de_plan_res_1 |   .9998925   .0000632    -1.70   0.089     .9997686    1.000016
              1.TD_1 |   1.000427   .0000776     5.50   0.000     1.000275    1.000579
--------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: Variables in tvc equation interacted with _t.

. estimates store m3_pwptt

. estwrite _all using &quot;${pathdata2}parmodels_m3_jun.sters&quot;
file C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/parmodels_m3_jun.sters already exists
r(602);

. 
</code></pre>
<p>=============================================================================</p>
<h2><a href="#pwp-gt" id="pwp-gt">PWP-GT</a></h2>
<p>=============================================================================</p>
<pre><code>. *In order to define time to each event from the time of the previous one, 
. *a gap time variable has to be generated, and initial times for all time spans are set to zero.
. use &quot;${pathdata2}five_st_msprep_jun.dta&quot;, clear 

. matrix mat_five_states = (.,1,.,.,. \ .,.,2,.,. \.,.,.,3,. \.,.,.,.,4 \.,.,.,.,.)

. msset, id(id) states(Readmission_status Readmission2_status Readmission3_status Readmission4_status) ///
&gt;                 times(Readmission_time Readmission2_time Readmission3_time Readmission4_time) transmatrix(mat_five_states)  //* saqué tipo_de_plan_res_1 para que no se empiece a subdividir

. gen time = _stop - _start

. gen time0=0

. *stset gap, fail(status) exit(time .) enter(time0)
. *https://www.stata.com/support/faqs/statistics/multiple-failure-time-data/#cond1
. stset time, fail(_status) exit(time .) enter(time0)

     failure event:  _status != 0 &amp; _status &lt; .
obs. time interval:  (0, time]
 enter on or after:  time time0
 exit on or before:  time .

------------------------------------------------------------------------------
     31,968  total observations
          0  exclusions
------------------------------------------------------------------------------
     31,968  observations remaining, representing
      9,261  failures in single-record/single-failure data
   44771646  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     4,431

. 
. cap noi drop sch* sca*
variable sch* not found

. stcox  i.tipo_de_plan_res_1 i.TD_1 i.TD_2 i.TD_3 i.TD_4, efron robust nolog strata(_trans) cluster(id) schoenfeld(sch*) scaledsch(sca*)

         failure _d:  _status
   analysis time _t:  time
  enter on or after:  time time0
  exit on or before:  time .

Stratified Cox regr. -- Efron method for ties

No. of subjects      =        2,584             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(5)     =       44.24
Log pseudolikelihood =   -11798.624             Prob &gt; chi2      =      0.0000

                                           (Std. Err. adjusted for 646 clusters in id)
--------------------------------------------------------------------------------------
                     |               Robust
                  _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
1.tipo_de_plan_res_1 |   1.129395   .0496617     2.77   0.006     1.036136    1.231048
              1.TD_1 |   .8158183   .0402612    -4.12   0.000      .740604    .8986711
              1.TD_2 |   .8863146    .048851    -2.19   0.029     .7955588    .9874237
              1.TD_3 |   .8196614   .0423381    -3.85   0.000     .7407425    .9069883
              1.TD_4 |   1.046975   .0567703     0.85   0.397     .9414153     1.16437
--------------------------------------------------------------------------------------
                                                          Stratified by _trans

. estat phtest, log detail

      Test of proportional-hazards assumption

      Time:  Log(t)
      ----------------------------------------------------------------
                  |       rho            chi2       df       Prob&gt;chi2
      ------------+---------------------------------------------------
      0b.tipo_de~1|            .            .        1             .
      1.tipo_de_~1|     -0.03405         2.38        1         0.1229
      0b.TD_1     |            .            .        1             .
      1.TD_1      |      0.08235        11.19        1         0.0008
      0b.TD_2     |            .            .        1             .
      1.TD_2      |      0.02669         1.37        1         0.2413
      0b.TD_3     |            .            .        1             .
      1.TD_3      |      0.04883         4.29        1         0.0383
      0b.TD_4     |            .            .        1             .
      1.TD_4      |      0.01798         0.64        1         0.4242
      ------------+---------------------------------------------------
      global test |                     20.87        5         0.0009
      ----------------------------------------------------------------

note: robust variance-covariance matrix used.

. * cluster(id)
</code></pre>
<p>We checked the proportionality of hazards visually</p>
<pre><code>. stphplot if _trans==1, by(tipo_de_plan_res_1) adjust(TD_1 _start) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: First transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_12, replace)  ///
&gt;         saving(stphplot_trans_12.gph, replace)

         failure _d:  _status
   analysis time _t:  time
  enter on or after:  time time0
  exit on or before:  time .
(file stphplot_trans_12.gph saved)

.         
. stphplot if _trans==2, by(tipo_de_plan_res_1) adjust(TD_1 TD_2 _start) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: Second transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_22, replace)  ///
&gt;         saving(stphplot_trans_22.gph, replace)

         failure _d:  _status
   analysis time _t:  time
  enter on or after:  time time0
  exit on or before:  time .
(file stphplot_trans_22.gph saved)

.         
. stphplot if _trans==3, by(tipo_de_plan_res_1) adjust(TD_1 TD_2 TD_3 _start) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: Third transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_32, replace)  ///
&gt;         saving(stphplot_trans_32.gph, replace)

         failure _d:  _status
   analysis time _t:  time
  enter on or after:  time time0
  exit on or before:  time .
(file stphplot_trans_32.gph saved)

.         
. stphplot if _trans==4, by(tipo_de_plan_res_1) adjust(TD_1 TD_2 TD_3 TD_4 _start) ///
&gt;  xtitle(&quot;Log Time (days)&quot;, size(small)) ///
&gt;         ylabel(-4(2)8, labsize(vsmall)) ///     
&gt;         legend(pos(7) ring(0) col(1) symysize(zero) keygap(1) symxsize(large) order( 1 2) lab(1 &quot;Outpatient&quot;) lab(2 &quot;Residential&quot;) size(small)) ///
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;by Treatment Modality at Baseline&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: Fourth transition}&quot;,size(small)) ///
&gt;         name(stphplot_trans_42, replace)  ///
&gt;         saving(stphplot_trans_42.gph, replace)

         failure _d:  _status
   analysis time _t:  time
  enter on or after:  time time0
  exit on or before:  time .
(file stphplot_trans_42.gph saved)

</code></pre>
<pre><code>. graph combine &quot;${pathdata}\stphplot_trans_12.gph&quot; &quot;${pathdata}\stphplot_trans_22.gph&quot; &quot;${pathdata}\stphplot_trans_32.gph&quot; &quot;${pathdata}\stphplot_trans_42.gph&quot;, ///
&gt; colfirst ycommon xcommon iscale(*.7) imargin(tiny) graphregion(color(gs16)) ///
&gt; title(&quot;Combination of −ln{−ln(survival)} vs. ln(analysis time)&quot; &quot;PWP-GT&quot;, size(medium)) cols(2) ///
&gt; subtitle(&quot;{it: in each transition}&quot;, size(small)) ///
&gt; note(&quot;{it:              Note: Ordered by columns, from up to down, left to right}&quot;, size(tiny))

. graph export &quot;_trans_ph_ln_surv_time2.png&quot;, as(png) replace width(2000) height(1000)
(file _trans_ph_ln_surv_time2.png written in PNG format)

. graph export &quot;_trans_ph_ln_surv_time2.pdf&quot;, as(pdf) replace //*width(2000) height(2000) orientation(landscape)
(file _trans_ph_ln_surv_time2.pdf written in PDF format)

</code></pre>
<p><img src="_trans_ph_ln_surv_time2.svg" width="800" ></p>
<p>Explored schoenfeld residuals:</p>
<pre><code>. drop sch* sca*

. stcox  i.tipo_de_plan_res_1 i.TD_1 i.TD_2 i.TD_3 i.TD_4, efron robust nolog strata(_trans) cluster(id) schoenfeld(sch*) scaledsch(sca*)

         failure _d:  _status
   analysis time _t:  time
  enter on or after:  time time0
  exit on or before:  time .

Stratified Cox regr. -- Efron method for ties

No. of subjects      =        2,584             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(5)     =       44.24
Log pseudolikelihood =   -11798.624             Prob &gt; chi2      =      0.0000

                                           (Std. Err. adjusted for 646 clusters in id)
--------------------------------------------------------------------------------------
                     |               Robust
                  _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
1.tipo_de_plan_res_1 |   1.129395   .0496617     2.77   0.006     1.036136    1.231048
              1.TD_1 |   .8158183   .0402612    -4.12   0.000      .740604    .8986711
              1.TD_2 |   .8863146    .048851    -2.19   0.029     .7955588    .9874237
              1.TD_3 |   .8196614   .0423381    -3.85   0.000     .7407425    .9069883
              1.TD_4 |   1.046975   .0567703     0.85   0.397     .9414153     1.16437
--------------------------------------------------------------------------------------
                                                          Stratified by _trans

. 
. estat phtest, log plot(tipo_de_plan_res_1) yline(0) msym(oh) ///
&gt;          xtitle(&quot;Time (days)&quot;, size(small)) ///
&gt;         xlabel(0(1460)5000, labsize(vsmall)) ///        
&gt;         ylabel(-4(1)4, labsize(vsmall)) ///     
&gt;         ytitle(&quot;Schoenfeld residuals&quot;, size(small)) scheme(sj) graphregion(color(white)) ///
&gt;         note(&quot;{it:Note. Means and 95% CI's; Bandwidth=.8; Natural log of analysis time used.}&quot;,size(vsmall)) ///
&gt;         title(&quot;Plot of scaled Schoenfeld residuals versus&quot; &quot;time produced for the covariate Treatment Completion&quot;, size(medium)) ///
&gt;         subtitle(&quot;{it: specified by Running mean smoother}&quot;,size(small)) ///
&gt;         name(phtest_log_TD_1_2, replace)  ///
&gt;         saving(phtest_log_TD_1_2.gph, replace)
tipo_de_plan_res_1 not found in model
r(198);

. ***The stphtest command with the plot option will provide the graphs with a lowess curve.  
. ***The usual graphing options can be used to include a horizontal reference line at y=0. 
</code></pre>
<p><img src="phtest_log_td_1_2.svg" width="800" ></p>
<pre><code>. qui estread &quot;${pathdata2}parmodels_m3_jun.sters&quot;

. stcox  i.tipo_de_plan_res_1 i.TD_1 i.TD_2 i.TD_3 i.TD_4, efron robust nolog strata(_trans) cluster(id) tvc(TD_1 _start)

         failure _d:  _status
   analysis time _t:  time
  enter on or after:  time time0
  exit on or before:  time .


Stratified Cox regr. -- Efron method for ties

No. of subjects      =        2,584             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(7)     =       68.46
Log pseudolikelihood =   -11782.622             Prob &gt; chi2      =      0.0000

                                           (Std. Err. adjusted for 646 clusters in id)
--------------------------------------------------------------------------------------
                     |               Robust
                  _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
main                 |
1.tipo_de_plan_res_1 |   1.144818   .0529169     2.93   0.003     1.045662    1.253376
              1.TD_1 |   .5759215   .0539924    -5.89   0.000     .4792514    .6920909
              1.TD_2 |   .8851279   .0514544    -2.10   0.036     .7898122    .9919464
              1.TD_3 |   .8165877    .044558    -3.71   0.000     .7337635    .9087607
              1.TD_4 |   1.064368    .060642     1.09   0.274     .9519081    1.190115
---------------------+----------------------------------------------------------------
tvc                  |
                TD_1 |   1.000549   .0001206     4.55   0.000     1.000312    1.000785
              _start |          1   7.14e-08     4.32   0.000            1           1
--------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: Variables in tvc equation interacted with _t.

. estimates store m3_pwpgt

. estwrite _all using &quot;${pathdata2}parmodels_m3_jun.sters&quot;, append
(appending m3_pwptt)
(appending m3_pwptt_td)
(appending m3_pwptt_td2)
(appending m3_pwpgt)
(appending m3_pwpgt_td)
(appending m3_pwpgt_td2)
(file C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/parmodels_m3_jun.sters saved)

</code></pre>
<h2><a href="#scvurve-tvc-predict-with-strata" id="scvurve-tvc-predict-with-strata">Scvurve tvc, predict with strata</a></h2>
<pre><code>




                id:  id
     failure event:  _status != 0 &amp; _status &lt; .
obs. time interval:  (_stop[_n-1], _stop]
 enter on or after:  time _start
 exit on or before:  time .

------------------------------------------------------------------------------
     31,968  total observations
          0  exclusions
------------------------------------------------------------------------------
     31,968  observations remaining, representing
     22,912  subjects
      9,261  failures in multiple-failure-per-subject data
   44771646  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =     4,431



------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Model m3_pwptt
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Efron method for ties

No. of subjects      =          646             Number of obs    =       2,584
No. of failures      =        2,143
Time at risk         =      1608281
                                                Wald chi2(8)     =       76.74
Log pseudolikelihood =   -10895.237             Prob &gt; chi2      =      0.0000

                                    (Std. Err. adjusted for 646 clusters in id)
-------------------------------------------------------------------------------
              |               Robust
           _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
main          |
_Itipo_de_p_1 |   1.280613   .1123619     2.82   0.005     1.078283    1.520907
     _ITD_1_1 |   .4625426   .0554156    -6.44   0.000     .3657398    .5849668
     _ITD_2_1 |   .9001604   .0515394    -1.84   0.066     .8046068    1.007062
     _ITD_3_1 |   .8389973   .0442634    -3.33   0.001     .7565773     .930396
     _ITD_4_1 |   1.076205   .0568508     1.39   0.164     .9703538    1.193603
       _start |   .9997396   .0000675    -3.85   0.000     .9996073     .999872
--------------+----------------------------------------------------------------
tvc           |
_Itipo_de_p_1 |   .9998925   .0000632    -1.70   0.089     .9997686    1.000016
     _ITD_1_1 |   1.000427   .0000776     5.50   0.000     1.000275    1.000579
-------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: Variables in tvc equation interacted with _t.

(note: variable scurve11 not found)
(note: variable scurve12 not found)
(note: variable scurve13 not found)
(note: variable scurve14 not found)

Dataset has been temporarily split at failure times
(2591 failure times)
(38,369,670 observations (episodes) created)

The estimation is based on the following Cox Proportional Hazards Model:

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Iteration 0:   log likelihood = -82581.503
Iteration 1:   log likelihood = -82421.162
Iteration 2:   log likelihood = -82420.956
Iteration 3:   log likelihood = -82420.956
Refining estimates:
Iteration 0:   log likelihood = -82420.956

Stratified Cox regr. -- Breslow method for ties

No. of subjects =       22,912                  Number of obs    =  38,401,638
No. of failures =        9,261
Time at risk    =     44771646
                                                LR chi2(3)       =      321.10
Log likelihood  =   -82420.956                  Prob &gt; chi2      =      0.0000

---------------------------------------------------------------------------------------
                   _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
   tipo_de_plan_res_1 |   1.934493   .1520631    12.72   0.000     1.636455    2.232531
_tipo_de_plan_res_1_t |  -.2512692   .0230117   -10.92   0.000    -.2963713   -.2061671
              _TD_1_t |  -.0138931   .0037447    -3.71   0.000    -.0212326   -.0065535
---------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: tvc-interactions denoted by _varname_t were interacted with ln(_t).
__000004* invalid name
r(198);

(note: variable scurve21 not found)
(note: variable scurve22 not found)
(note: variable scurve23 not found)
(note: variable scurve24 not found)

Dataset has been temporarily split at failure times
(2591 failure times)
(38,369,670 observations (episodes) created)

The estimation is based on the following Cox Proportional Hazards Model:

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Iteration 0:   log likelihood = -82581.503
Iteration 1:   log likelihood = -82421.162
Iteration 2:   log likelihood = -82420.956
Iteration 3:   log likelihood = -82420.956
Refining estimates:
Iteration 0:   log likelihood = -82420.956

Stratified Cox regr. -- Breslow method for ties

No. of subjects =       22,912                  Number of obs    =  38,401,638
No. of failures =        9,261
Time at risk    =     44771646
                                                LR chi2(3)       =      321.10
Log likelihood  =   -82420.956                  Prob &gt; chi2      =      0.0000

---------------------------------------------------------------------------------------
                   _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
   tipo_de_plan_res_1 |   1.934493   .1520631    12.72   0.000     1.636455    2.232531
_tipo_de_plan_res_1_t |  -.2512692   .0230117   -10.92   0.000    -.2963713   -.2061671
              _TD_1_t |  -.0138931   .0037447    -3.71   0.000    -.0212326   -.0065535
---------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: tvc-interactions denoted by _varname_t were interacted with ln(_t).
__000004* invalid name
r(198);

(2,110 real changes made)
(16,514 missing values generated)
(18,482 real changes made)
(25,286 missing values generated)
(26,201 real changes made)
(29,384 missing values generated)
(29,732 real changes made)


(0 real changes made)
(1,420 real changes made)
(395 real changes made)
(116 real changes made)



------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Model m3_pwpgt_td2
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Efron method for ties

No. of subjects      =       31,968             Number of obs    =      31,968
No. of failures      =        9,261
Time at risk         =     44771646
                                                Wald chi2(6)     =      518.39
Log pseudolikelihood =   -83762.882             Prob &gt; chi2      =      0.0000

                                 (Std. Err. adjusted for 22,912 clusters in id)
-------------------------------------------------------------------------------
              |               Robust
           _t | Haz. Ratio   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
main          |
_Itipo_de_p_1 |   1.612685   .0550757    13.99   0.000     1.508272    1.724326
       _ITD_1 |   .5577293   .0207699   -15.68   0.000     .5184712    .5999599
       _start |    .999594   .0000526    -7.72   0.000      .999491    .9996971
--------------+----------------------------------------------------------------
tvc           |
_Itipo_de_p_1 |   .9997666   .0000346    -6.74   0.000     .9996987    .9998344
       _ITD_1 |   1.000503   .0000363    13.87   0.000     1.000432    1.000574
       _start |          1   7.73e-08     5.44   0.000            1    1.000001
-------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: Variables in tvc equation interacted with _t.

(note: variable scurve11 not found)
(note: variable scurve12 not found)
(note: variable scurve13 not found)
(note: variable scurve14 not found)

Dataset has been temporarily split at failure times
(2591 failure times)
(38,369,670 observations (episodes) created)

The estimation is based on the following Cox Proportional Hazards Model:

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Iteration 0:   log likelihood = -82581.503
Iteration 1:   log likelihood = -82366.907
Iteration 2:   log likelihood = -82366.666
Iteration 3:   log likelihood = -82366.666
Refining estimates:
Iteration 0:   log likelihood = -82366.666

Stratified Cox regr. -- Breslow method for ties

No. of subjects =       22,912                  Number of obs    =  38,401,638
No. of failures =        9,261
Time at risk    =     44771646
                                                LR chi2(4)       =      429.68
Log likelihood  =   -82366.666                  Prob &gt; chi2      =      0.0000

---------------------------------------------------------------------------------------
                   _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
   tipo_de_plan_res_1 |   1.916475   .1520318    12.61   0.000     1.618498    2.214452
_tipo_de_plan_res_1_t |  -.2473525   .0229991   -10.75   0.000      -.29243   -.2022751
                _TD_t |  -.0212294   .0037299    -5.69   0.000    -.0285399    -.013919
            __start_t |   .0000551   5.83e-06     9.44   0.000     .0000436    .0000665
---------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: tvc-interactions denoted by _varname_t were interacted with ln(_t).
__000004* invalid name
r(198);

(note: variable scurve21 not found)
(note: variable scurve22 not found)
(note: variable scurve23 not found)
(note: variable scurve24 not found)

Dataset has been temporarily split at failure times
(2591 failure times)
(38,369,670 observations (episodes) created)

The estimation is based on the following Cox Proportional Hazards Model:

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Iteration 0:   log likelihood = -82581.503
Iteration 1:   log likelihood = -82366.907
Iteration 2:   log likelihood = -82366.666
Iteration 3:   log likelihood = -82366.666
Refining estimates:
Iteration 0:   log likelihood = -82366.666

Stratified Cox regr. -- Breslow method for ties

No. of subjects =       22,912                  Number of obs    =  38,401,638
No. of failures =        9,261
Time at risk    =     44771646
                                                LR chi2(4)       =      429.68
Log likelihood  =   -82366.666                  Prob &gt; chi2      =      0.0000

---------------------------------------------------------------------------------------
                   _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
   tipo_de_plan_res_1 |   1.916475   .1520318    12.61   0.000     1.618498    2.214452
_tipo_de_plan_res_1_t |  -.2473525   .0229991   -10.75   0.000      -.29243   -.2022751
                _TD_t |  -.0212294   .0037299    -5.69   0.000    -.0285399    -.013919
            __start_t |   .0000551   5.83e-06     9.44   0.000     .0000436    .0000665
---------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: tvc-interactions denoted by _varname_t were interacted with ln(_t).
__000004* invalid name
r(198);

(note: variable scurve11 not found)
(note: variable scurve12 not found)
(note: variable scurve13 not found)
(note: variable scurve14 not found)

Dataset has been temporarily split at failure times
(2591 failure times)
(38,369,670 observations (episodes) created)

The estimation is based on the following Cox Proportional Hazards Model:

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Iteration 0:   log likelihood = -82581.503
Iteration 1:   log likelihood = -82411.278
Iteration 2:   log likelihood = -82411.062
Iteration 3:   log likelihood = -82411.062
Refining estimates:
Iteration 0:   log likelihood = -82411.062

Stratified Cox regr. -- Breslow method for ties

No. of subjects =       22,912                  Number of obs    =  38,401,638
No. of failures =        9,261
Time at risk    =     44771646
                                                LR chi2(3)       =      340.88
Log likelihood  =   -82411.062                  Prob &gt; chi2      =      0.0000

---------------------------------------------------------------------------------------
                   _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
   tipo_de_plan_res_1 |   1.953245   .1521651    12.84   0.000     1.655007    2.251483
_tipo_de_plan_res_1_t |  -.2539323   .0230168   -11.03   0.000    -.2990444   -.2088202
                _TD_t |   -.021409   .0037295    -5.74   0.000    -.0287186   -.0140994
---------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: tvc-interactions denoted by _varname_t were interacted with ln(_t).
__000004* invalid name
r(198);

(note: variable scurve21 not found)
(note: variable scurve22 not found)
(note: variable scurve23 not found)
(note: variable scurve24 not found)

Dataset has been temporarily split at failure times
(2591 failure times)
(38,369,670 observations (episodes) created)

The estimation is based on the following Cox Proportional Hazards Model:

         failure _d:  _status
   analysis time _t:  _stop
  enter on or after:  time _start
  exit on or before:  time .
                 id:  id

Iteration 0:   log likelihood = -82581.503
Iteration 1:   log likelihood = -82411.278
Iteration 2:   log likelihood = -82411.062
Iteration 3:   log likelihood = -82411.062
Refining estimates:
Iteration 0:   log likelihood = -82411.062

Stratified Cox regr. -- Breslow method for ties

No. of subjects =       22,912                  Number of obs    =  38,401,638
No. of failures =        9,261
Time at risk    =     44771646
                                                LR chi2(3)       =      340.88
Log likelihood  =   -82411.062                  Prob &gt; chi2      =      0.0000

---------------------------------------------------------------------------------------
                   _t |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
   tipo_de_plan_res_1 |   1.953245   .1521651    12.84   0.000     1.655007    2.251483
_tipo_de_plan_res_1_t |  -.2539323   .0230168   -11.03   0.000    -.2990444   -.2088202
                _TD_t |   -.021409   .0037295    -5.74   0.000    -.0287186   -.0140994
---------------------------------------------------------------------------------------
                                                          Stratified by _trans
Note: tvc-interactions denoted by _varname_t were interacted with ln(_t).
__000004* invalid name
r(198);

</code></pre>
<p>Saved at= 14:35:12 22 Sep 2021</p>
