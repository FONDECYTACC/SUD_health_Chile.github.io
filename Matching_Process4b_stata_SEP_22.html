<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<head>
  <link rel="stylesheet" type="text/css" href="stmarkdown.css">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<h1><a href="#database-step-4b" id="database-step-4b">Database (step 4b)</a></h1>
<p>Date created: 23 Sep 2022.</p>
<p>Install commands that are unavailable or out of date.</p>
<pre><code>. clear all

. 
. cap noi which predictms
c:\ado\plus\p\predictms.ado
*! version 4.4.0 22dec2021 MJC

. if _rc==111 {
.         cap noi net install multistate, from(&quot;https://www.mjcrowther.co.uk/code/multistate&quot;) 
.         }

. cap noi which merlin
c:\ado\plus\m\merlin.ado
*! version 2.1.5 18mar2022 MJC

. if _rc==111 {
.         cap noi net install merlin, from(&quot;https://www.mjcrowther.co.uk/code/merlin/&quot;) 
.         }

. cap noi which sumat
c:\ado\plus\s\sumat.ado
*! Part of package matrixtools v. 0.28
*! Support: Niels Henrik Bruun, niels.henrik.bruun@gmail.com
*! 2021-01-03 toxl added

. if _rc==111 {
.         cap noi scc install matrixtools
.         }

. cap noi which estwrite
c:\ado\plus\e\estwrite.ado
*! version 1.2.4 04sep2009
*! version 1.0.1 15may2007 (renamed from -eststo- to -estwrite-; -append- added)
*! version 1.0.0 29apr2005 Ben Jann (ETH Zurich)

. if _rc==111 {
.         cap noi ssc install estwrite
.         }       

.         
. cap noi which scurve_tvc
c:\ado\plus\s\scurve_tvc.ado

. if _rc==111 {
.         cap noi net install st0458.pkg
.         }

. cap noi which strmcure  
c:\ado\plus\s\strmcure.ado
*! Version 4.0 31-Aug-2015

. if _rc==111 {
.         net install st0374_1.pkg
.         }

. cap noi which stjmgraph 
c:\ado\plus\s\stjmgraph.ado
*! version 1.0.2 01Jun2011 MJC

. if _rc==111 {
.         net install st0289.pkg
.         }       

</code></pre>
<p>We need to obtain the file and the work folder.</p>
<pre><code>. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;/volumes/sdrive/data//&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;/volumes/sdrive/data//&quot;
.         global pathdata &quot;/volumes/sdrive/data//&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags
.         global pathdata &quot;E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;E:/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
Location= E:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags; Date: 23 Sep 2022, considering an OS Windows for the user: andre
. }

. else display &quot;This file does not exist&quot;

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;G:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;G:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata &quot;G:\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;G:/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

.                 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)&quot;
.         global pathdata &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;C:\Users\andre\Desktop\_mult_state_ags\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;C:\Users\andre\Desktop\_mult_state_ags&quot;
.         global pathdata &quot;C:\Users\andre\Desktop\_mult_state_ags&quot;
.         global pathdata2 &quot;C:/Users/andre/Desktop/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

. 
. mata : st_numscalar(&quot;OK&quot;, direxists(&quot;C:\Users\CISS Fondecyt\OneDrive\Documentos\&quot;))

. if scalar(OK) == 1 {
.         cap noi cd &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata &quot;C:\Users\CISS Fondecyt\Mi unidad\Alvacast\SISTRAT 2019 (github)\_mult_state_ags&quot;
.         global pathdata2 &quot;C:/Users/CISS Fondecyt/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/&quot;
.         di &quot;Location= ${pathdata}; Date: `c(current_date)', considering an OS `c(os)' for the user: `c(username)'&quot;
. }

. else display &quot;This file does not exist&quot;
This file does not exist

. 
</code></pre>
<p>Path data= E:\Mi unidad\Alvacast\SISTRAT 2019 (github)_mult_state_ags;</p>
<p>Timestamp: 23 Sep 2022, considering that is a Windows OS for the username: andre</p>
<p>The file is located and named as: E:/Mi unidad/Alvacast/SISTRAT 2019 (github)/_mult_state_ags/archivo_multiestado1_jul_22_corr_3y.dta</p>
<p>.         use &ldquo;${pathdata2}archivo_multiestado1_jul_22_corr_3y.dta&rdquo;, clear</p>
<p>.         global sim 1e5 //5e1 1e5</p>
<p>.         global boots 2e3 //5e1 2e3</p>
<p>Defined transition matrix.</p>
<p>=============================================================================</p>
<h2><a href="#ambulatory-parametric-models-of-differences-ratios-between-completion-and-non-completion-of-baseline-treatment-at-3-years" id="ambulatory-parametric-models-of-differences-ratios-between-completion-and-non-completion-of-baseline-treatment-at-3-years">Ambulatory- Parametric models of differences &amp; ratios between Completion and Non-completion of baseline treatment- At 3 years</a></h2>
<p>=============================================================================</p>
<pre><code>. qui estread &quot;${pathdata2}parmodels_m2_jun_22_corr.sters&quot;

. 
. predictms, transmatrix(mat_five_states) models(m2_1_rp5 m2_2_rp4 m2_3_rp2 m2_4_rp3) ///
&gt;          timevar(timevar0) /// mint(0) maxt(1096) timevar() cannot be specified with mint()/maxt()/obs()
&gt;          seed(2125) n($sim) prob los diff /// * si agrego bootstrap, at#() limit reached, or unrecognised option
&gt;          from(1) ci reset bootstrap m($boots)  /// * es una forma de hacer bootstrap 
&gt;          at1(tipo_de_plan_res_1 0 TD_1 0 TD_2 0 TD_3 0 _start 1096) at2(tipo_de_plan_res_1 0 TD_1 1 TD_2 0 TD_3 0 _start 1096) 

Calculating CIs via parametric bootstrap for at1() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

Calculating CIs via parametric bootstrap for at2() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

.                                  
. rename (_prob_at1_1_*) (fprob2a_from1a_*_3y_rp)

. rename (_prob_at2_1_*) (fprob2a_from1b_*_3y_rp)

. 
. rename (_diff_prob_at2_1_*_lci) (fdiff2a_prob_from1_*_lci_3y_rp)

. rename (_diff_prob_at2_1_*_uci) (fdiff2a_prob_from1_*_uci_3y_rp)

. rename (_diff_prob_at2_1_*) (fdiff2a_prob_from1_*_3y_rp)

. 
. rename (_diff_los_at2_1_*_lci) (fdiff2a_los_from1_*_lci_3y_rp)

. rename (_diff_los_at2_1_*_uci) (fdiff2a_los_from1_*_uci_3y_rp)

. rename (_diff_los_at2_1_*) (fdiff2a_los_from1_*_3y_rp)  

. 
</code></pre>
<pre><code>. qui estread &quot;${pathdata2}parmodels_m2_jun_22_corr.sters&quot;

. 
. predictms, transmatrix(mat_five_states) models(m2_1_rp5 m2_2_rp4 m2_3_rp2 m2_4_rp3) ///
&gt;          timevar(timevar0) /// mint(0) maxt(1096) timevar() cannot be specified with mint()/maxt()/obs()
&gt;          seed(2125) n($sim) prob los diff /// * si agrego bootstrap, at#() limit reached, or unrecognised option
&gt;          from(2) ci reset bootstrap m($boots)  /// * es una forma de hacer bootstrap 
&gt;          at1(tipo_de_plan_res_1 0 TD_1 0 TD_2 0 TD_3 0 _start 1096) at2(tipo_de_plan_res_1 0 TD_1 1 TD_2 0 TD_3 0 _start 1096) 

Calculating CIs via parametric bootstrap for at1() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

Calculating CIs via parametric bootstrap for at2() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

.                                  
. rename (_prob_at1_2_*) (fprob2a_from2a_*_3y_rp)

. rename (_prob_at2_2_*) (fprob2a_from2b_*_3y_rp)

. 
. rename (_diff_prob_at2_2_*_lci) (fdiff2a_prob_from2_*_lci_3y_rp)

. rename (_diff_prob_at2_2_*_uci) (fdiff2a_prob_from2_*_uci_3y_rp)

. rename (_diff_prob_at2_2_*) (fdiff2a_prob_from2_*_3y_rp)  

. 
. rename (_diff_los_at2_2_*_lci) (fdiff2a_los_from2_*_lci_3y_rp)

. rename (_diff_los_at2_2_*_uci) (fdiff2a_los_from2_*_uci_3y_rp)

. rename (_diff_los_at2_2_*) (fdiff2a_los_from2_*_3y_rp)  

. 
</code></pre>
<pre><code>. qui estread &quot;${pathdata2}parmodels_m2_jun_22_corr.sters&quot;

. 
. predictms, transmatrix(mat_five_states) models(m2_1_rp5 m2_2_rp4 m2_3_rp2 m2_4_rp3) ///
&gt;          timevar(timevar0) /// mint(0) maxt(1096) timevar() cannot be specified with mint()/maxt()/obs()
&gt;          seed(2125) n($sim) prob los diff /// * si agrego bootstrap, at#() limit reached, or unrecognised option
&gt;          from(3) ci reset bootstrap m($boots)  /// * es una forma de hacer bootstrap 
&gt;          at1(tipo_de_plan_res_1 0 TD_1 0 TD_2 0 TD_3 0 _start 1096) at2(tipo_de_plan_res_1 0 TD_1 1 TD_2 0 TD_3 0 _start 1096) 

Calculating CIs via parametric bootstrap for at1() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

Calculating CIs via parametric bootstrap for at2() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

.                                  
. rename (_prob_at1_3_*) (fprob2a_from3a_*_3y_rp)

. rename (_prob_at2_3_*) (fprob2a_from3b_*_3y_rp)

. 
. rename (_diff_prob_at2_3_*_lci) (fdiff2a_prob_from3_*_lci_3y_rp)

. rename (_diff_prob_at2_3_*_uci) (fdiff2a_prob_from3_*_uci_3y_rp)

. rename (_diff_prob_at2_3_*) (fdiff2a_prob_from3_*_3y_rp)  

. 
. rename (_diff_los_at2_3_*_lci) (fdiff2a_los_from3_*_lci_3y_rp)

. rename (_diff_los_at2_3_*_uci) (fdiff2a_los_from3_*_uci_3y_rp)

. rename (_diff_los_at2_3_*) (fdiff2a_los_from3_*_3y_rp)  

. 
</code></pre>
<pre><code>. qui estread &quot;${pathdata2}parmodels_m2_jun_22_corr.sters&quot;

. 
. predictms, transmatrix(mat_five_states) models(m2_1_rp5 m2_2_rp4 m2_3_rp2 m2_4_rp3) ///
&gt;          timevar(timevar0) /// mint(0) maxt(1096) timevar() cannot be specified with mint()/maxt()/obs()
&gt;          seed(2125) n($sim) prob los diff /// * si agrego bootstrap, at#() limit reached, or unrecognised option
&gt;          from(4) ci reset bootstrap m($boots)  /// * es una forma de hacer bootstrap 
&gt;          at1(tipo_de_plan_res_1 0 TD_1 0 TD_2 0 TD_3 0 _start 1096) at2(tipo_de_plan_res_1 0 TD_1 1 TD_2 0 TD_3 0 _start 1096) 

Calculating CIs via parametric bootstrap for at1() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

Calculating CIs via parametric bootstrap for at2() (2000)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..................................................    50
..................................................   100
..................................................   150
..................................................   200
..................................................   250
..................................................   300
..................................................   350
..................................................   400
..................................................   450
..................................................   500
..................................................   550
..................................................   600
..................................................   650
..................................................   700
..................................................   750
..................................................   800
..................................................   850
..................................................   900
..................................................   950
..................................................  1000
..................................................  1050
..................................................  1100
..................................................  1150
..................................................  1200
..................................................  1250
..................................................  1300
..................................................  1350
..................................................  1400
..................................................  1450
..................................................  1500
..................................................  1550
..................................................  1600
..................................................  1650
..................................................  1700
..................................................  1750
..................................................  1800
..................................................  1850
..................................................  1900
..................................................  1950
..................................................  2000

.                                  
. rename (_prob_at1_4_*) (fprob2a_from4a_*_3y_rp)

. rename (_prob_at2_4_*) (fprob2a_from4b_*_3y_rp)

.         
. rename (_diff_prob_at2_4_*_lci) (fdiff2a_prob_from4_*_lci_3y_rp)

. rename (_diff_prob_at2_4_*_uci) (fdiff2a_prob_from4_*_uci_3y_rp)

. unexpected end of do-file
</code></pre>
